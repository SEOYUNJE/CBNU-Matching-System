
<!-- cbnu_match/moit/templates/search/search.html -->
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>모임 검색</title>
  <style>
    .filter-box { margin-bottom: 20px; }
    .search-input { width: 300px; padding: 5px; }
    .select-box { padding: 5px; margin-right: 10px; }
    .meet-card { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; }
  </style>
</head>
<body>
  <h1>🔍 모임 검색 테스트</h1>

  <form method="get">
    <div class="filter-box">
      <input type="text" name="query" class="search-input" placeholder="검색어를 입력하세요" value="{{ query }}">

      <select name="main_type" class="select-box" onchange="this.form.submit()">
        <option value="">-- 대주제 선택 --</option>
        <option value="created" {% if main_type == 'created' %}selected{% endif %}>만든 날짜</option>
        <option value="participant" {% if main_type == 'participant' %}selected{% endif %}>인원수</option>
        <option value="category" {% if main_type == 'category' %}selected{% endif %}>카테고리</option>
        <option value="all" {% if main_type == 'all' %}selected{% endif %}>전체</option>
      </select>

      <select name="sub_type" class="select-box">
        {% for value, label in form.fields.sub_type.choices %}
          <option value="{{ value }}" {% if value == sub_type %}selected{% endif %}>{{ label }}</option>
        {% endfor %}
      </select>

      <button type="submit">🔍 검색</button>
    </div>
  </form>

  <hr>

  <div>
    {% if results %}
      <h3>검색 결과 (총 {{ results.paginator.count }}개):</h3>
      {% for meet in results %}
        <div class="meet-card">
          <strong>{{ meet.title }}</strong><br>
          카테고리: {{ meet.category }}<br>
          참가자 수: {{ meet.num_participants }}명<br>
          생성일: {{ meet.created_at|date:"Y-m-d H:i" }}<br>
        </div>
      {% endfor %}
    {% else %}
      <p>검색 결과가 없습니다.</p>
    {% endif %}
  </div>

  <!-- 페이지네이션 -->
  <div>
    {% if results.has_previous %}
      <a href="?page={{ results.previous_page_number }}&query={{ query }}&main_type={{ main_type }}&sub_type={{ sub_type }}">이전</a>
    {% endif %}

    <span>페이지 {{ results.number }} / {{ results.paginator.num_pages }}</span>

    {% if results.has_next %}
      <a href="?page={{ results.next_page_number }}&query={{ query }}&main_type={{ main_type }}&sub_type={{ sub_type }}">다음</a>
    {% endif %}
  </div>
</body>
</html>