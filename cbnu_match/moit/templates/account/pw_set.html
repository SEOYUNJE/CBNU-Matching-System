{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="{% static 'account/css/pw_set.css' %}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
</head>
<body>
  <header class="header">
    <div class="logo">moit</div>
    <nav class="nav">
      <a href="#">meals</a>
      <a href="#">study</a>
      <a href="#">game</a>
      <a href="#">exercise</a>
    </nav>
    <div class="util">ğŸ” ğŸ‘¤</div>
  </header>

  <main>
    <div class="pw_set-container">
      <h1 class="title">ë³¸ì¸ ì¸ì¦í•˜ê¸°</h1>

      <form id="input-form" novalidate>
 <!-- ì„± â€¢ ì´ë¦„ í•„ë“œ (2ì—´ ê·¸ë¦¬ë“œ) -->
        <div class="field name-fields">

          <div class="field-group">
            <label for="last-name">ì„±</label>
            <input id="last-name"
                   type="text"
                   placeholder="ì„± ì…ë ¥"
                   required>
          </div>

          <div class="field-group">
            <label for="first-name">ì´ë¦„</label>
            <input id="first-name"
                   type="text"
                   placeholder="ì´ë¦„ ì…ë ¥"
                   required>
          </div>
        </div>

        <!-- ì•„ì´ë”” -->
        <div class="field">
          <label for="user-id">ì•„ì´ë””</label>
          <input
            id="user-id"
            type="text"
            placeholder="ì•„ì´ë”” ì…ë ¥"
            required />
        </div>

        <!-- ê°€ì… ë²„íŠ¼ -->
        <button type="submit" class="btn-id_find" disabled>í™•ì¸í•˜ê¸°</button>
      </form>
      <div class="links">
        <a href="#">ì•„ì´ë”” ì°¾ê¸°</a> | 
        <a href="#">ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •</a> | 
        <a href="#">íšŒì›ê°€ì…</a>
      </div>
    </div>
  </main>

 

<script>
  /*1. inputì— ì…ë ¥ì´ ìˆì–´ì•¼ ë²„íŠ¼ í™œì„±í™”ë¨
  2. í¼ì œì¶œì‹œ 
  ì„±ê³µ-> ê²°ê³¼ í˜ì´ì§€ë¡œ ì´ë™
  ì‹¤íŒ¨-> ì¼ì¹˜ ì•„ì´ë”” ì—†ë‹¤ê³  alertëœ¸
  error-> alert

  */
  
  // 1) ëª¨ë“  inputì— ì…ë ¥ì´ ìˆì–´ì•¼ ë²„íŠ¼ í™œì„±í™”
  $('#input-form input').on('input', function() {
    const allFilled = $('#input-form input').toArray().every(el => el.value.trim() !== '');
    $('.btn-id_find').prop('disabled', !allFilled);
  });

  // 2) í¼ ì œì¶œ ì²˜ë¦¬
  $('#input-form').on('submit', function(e) {
    e.preventDefault();

    const last  = $('#last-name').val().trim();
    const first = $('#first-name').val().trim();
    const userId = $('#user-id').val().trim();

    $.ajax({
      url: '/api/find-id/',    // ì‹¤ì œ API ì—”ë“œí¬ì¸íŠ¸ì— ë§ê²Œ ìˆ˜ì •
      type: 'POST',
      data: {
        last_name: last,
        first_name: first,
        userId: userId
      },
      dataType: 'json',
      success: function(res) {
        if (res && res.id) {
          // ì„±ê³µ: ê²°ê³¼ í˜ì´ì§€ë¡œ ì´ë™
          window.location.href = 'id_find_result.html?userId=' + encodeURIComponent(res.id);
        } else {
          // ì‹¤íŒ¨: ì¼ì¹˜í•˜ëŠ” ì•„ì´ë”” ì—†ìŒ
          alert('ì…ë ¥í•˜ì‹  ì •ë³´ì™€ ì¼ì¹˜í•˜ëŠ” ì•„ì´ë””ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.');
        }
      },
      error: function() {
        alert('ì„œë²„ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
      }
    });
  });
</script>


</body>
</html>
